@{
    ViewBag.Title = "Edit Candidate";
}

@section AddToTextCSS {
    .tabs a {
    outline: 0;
    }

    .classes-table {
    width: 100%;
    border: 1px solid black;
    }

    .classes-table > * {
    text-align: center;
    }

    /* Vertical tabs CSS */
    .ui-tabs.ui-tabs-vertical {
    padding: 0;
    width: 100%;
    }
    .ui-tabs.ui-tabs-vertical .ui-widget-header {
    border: none;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav {
    float: left;
    width: 15%;
    border-radius: 4px 0 0 4px;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav li {
    clear: left;
    width: 100%;
    margin: 0.2em 0;
    border-width: 1px 0 1px 1px;
    border-radius: 4px 0 0 4px;
    overflow: hidden;
    position: relative;
    right: -2px;
    z-index: 2;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav li a {
    display: block;
    width: 100%;
    padding: 0.6em 1em;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav li a:hover {
    cursor: pointer;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav li.ui-tabs-active {
    margin-bottom: 0.2em;
    padding-bottom: 0;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-nav li:last-child {
    margin-bottom: 10px;
    }
    .ui-tabs.ui-tabs-vertical .ui-tabs-panel {
    float: right;
    width: 75%;
    border-radius: 0;
    position: relative;
    left: -1px;
    }

    /* Hides top of dialog */
    .no-close .ui-dialog-titlebar-close {
    display: none;
    }

    .createLink {
    padding: 8px;
    border-top: 1px solid #ccc;
    font-family: Helvetica,Arial,sans-serif;
    font-size: 1em;
    text-align: center;
    }

    #course-catalog-table {
    width: 100%;
    }
}

<!--Basic Information Block-->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="biodata-panel">
        <div class="panel-heading">
            <h2 class="panel-title">Basic Candidate Information</h2>
        </div>
        <div class="row-fluid">
            <!-- First column, name etc-->
            <form id="biodata-form" class="form-horizontal">
                <div class="span4 panel-body">
                    <div class="form-group">
                        <label for="FName" class="control-label span5">First Name</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="FName" id="FName" value="@ViewBag.bioData.FName" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="MName" class="control-label span5">Middle Name</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="MName" id="MName" value="@ViewBag.bioData.MName" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="LName" class="control-label span5">Last Name</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="LName" id="LName" value="@ViewBag.bioData.LName" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="SSN" class="control-label span5">SSN</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="SSN" id="SSN" value="@ViewBag.bioData.SSN" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Suffix" class="control-label span5">Suffix</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="Suffix" id="Suffix" value="@ViewBag.bioData.Suffix" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="FYG" class="control-label span5">Fiscal Year Group</label>
                        <div class="span7">
                            <input type="text" class="form-control span11" name="FYG" id="FYG" value="@ViewBag.bioData.FYG" />
                        </div>
                    </div>
                </div>
                <!-- Second column, date of birth, gender, etc-->
                <div class="span4 panel-body">
                    <div class="form-group">
                        <label for="DOB" class="control-label span4">Date of Birth</label>
                        <div class="span8">
                            <input type="text" class="date form-control span12" name="DOB" id="DOB" value="@ViewBag.bioData.DOB" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Sex" class="control-label span4">Sex</label>

                        <div class="span8">
                            <select id="Sex" name="Sex">
                                <option value="M" @if (ViewBag.bioData.Sex == Sex.M.ToString()) { <text> selected </text>     }>M</option>
                                <option value="F" @if (ViewBag.bioData.Sex == Sex.F.ToString()) { <text> selected </text>     }>F</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="EthnicityID" class="control-label span4">Ethnicity</label>
                        <div class="span8">
                            <select id="EthnicityID" name="EthnicityID">
                                @foreach (var e in ViewBag.ethnicities)
                                {
                                <option value="@e.EthnicityID"
                                        @if (ViewBag.bioData.EthnicityID == e.EthnicityID) { <text> selected </text>                   }>
                                    @e.EthnicityValue
                                </option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="SourcesID" class="control-label span4">Source</label>
                        <div class="span8">
                            <select id="SourcesID" name="SourcesID">
                                @foreach (var s in ViewBag.sources)
                                {
                                <option value="@s.SourcesID"
                                        @if (ViewBag.bioData.SourcesID == s.SourcesID) { <text> selected </text>                   }>
                                    @s.SourcesValue
                                </option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="SubSourcesID" class="control-label span4">SubSource</label>
                        <div class="span8">
                            <select id="SubSourcesID" name="SubSourcesID">
                                <option value="">--None--</option>
                                @foreach (var s in ViewBag.subsources)
                                {
                                <option value="@s.SubSourcesID"
                                        @if (ViewBag.bioData.SubSourcesID == s.SubSourcesID) { <text> selected </text>                   }>
                                    @s.SubSourcesValue
                                </option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Programs" class="control-label span4">Programs</label>
                        <div class="span8">
                            <select id="BiodataPrograms" name="BiodataPrograms" multiple>
                                @foreach (var p in ViewBag.programs)
                                {
                                <option value="@p.ProgramID" @if(ViewBag.bioData.Programs.Contains(p)) { <text>selected</text> }>@p.ProgramValue</option>
                                }
                            </select>
                        </div>
                    </div>
                </div>
                <!-- Third column, ACT/SAT scores-->
                <div class="span4 panel-body">
                    <div class="form-group">
                        <label for="ACTM" class="control-label span4">ACT Math</label>
                        <div class="span8">
                            <input type="text" class="form-control span10" name="ACTM" id="ACTM" value="@ViewBag.bioData.ACTM" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="ACTV" class="control-label span4">ACT Verbal</label>
                        <div class="span8">
                            <input type="text" class="form-control span10" name="ACTV" id="ACTV" value="@ViewBag.bioData.ACTV" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="SATM" class="control-label span4">SAT Math</label>
                        <div class="span8">
                            <input type="text" class="form-control span10" name="SATM" id="SATM" value="@ViewBag.bioData.SATM" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="SATV" class="control-label span4">SAT Verbal</label>
                        <div class="span8">
                            <input type="text" class="form-control span10" name="SATV" id="SATV" value="@ViewBag.bioData.SATV" />
                        </div>
                    </div>
                </div>
                <input type="hidden" name="ID" id="ID" value="@ViewBag.bioData.ID" />
            </form> <!-- End of biodata-form -->
        </div>
        <div class="row-fluid">
            <div id="biodata-errors" class="alert hide alert-error span10 offset1">
                <p></p>
            </div>
        </div>
    </div>
</div>
<!-- School information block -->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="schools-panel">
        <div class="panel-heading">
            <h2 class="panel-title">School Information</h2>
        </div>
        <div class="tabs" id="school-tabs">
            <ul>
                <li><a href="#school-content-1"></a></li>
                @{int i = 1;}
                @foreach (var sa in ViewBag.schoolsAttended)
                {
                <li><a href="#school-content-@i">@sa.School.SchoolValue</a></li>
                    i++;
                }
                <li id="add-school-tab"><a href="#add-school"><i class="fa fa-plus"></i></a></li>
            </ul>
            <div class="hide" id="school-content-1">
                <form class="form-horizontal schools-form">
                    <div class="row-fluid">
                        <!--School info block-->
                        <div class="span12 panel-body">
                            <div class="row-fluid">
                                <div class="span5">
                                    <div class="form-group">
                                        <label for="YearStart" class="control-label span3">Start Year</label>
                                        <div class="span4">
                                            <input type="text" class="form-control span10" name="YearStart" id="YearStart" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="YearEnd" class="control-label span3">End Year</label>
                                        <div class="span4">
                                            <input type="text" class="form-control span10" name="YearEnd" id="YearEnd" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="Graduated" class="control-label span3">Graduated?</label>
                                        <div class="span2">
                                            <select id="Graduated" name="Graduated" class="span12">
                                                <option value="true">Yes</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!-- Fake values to pass test, get reassigned on submittal -->
                                    <input type="hidden" name="SchoolID" id="SchoolID" value="1" />
                                    <input type="hidden" name="BioDataID" id="BioDataID" value="1" />
                                </div>
                                <div class="span7">
                                    <!-- TODO: Need to have more than one major and more than one degree-->
                                    <div class="form-group">
                                        <label for="MajorValue" class="control-label span3">Major</label>
                                        <div class="span4">
                                            <select id="MajorValue" name="MajorValue" class="span10">
                                                @foreach (var m in ViewBag.majors)
                                                {
                                                <option value="@m.MajorValue">@m.MajorValue</option>
                                                }
                                            </select>
                                            <!-- Holder value, gets set on submit -->
                                            <input type="hidden" name="MajorID" id="MajorID" value="1" />
                                        </div>
                                        <label for="DegreeTypeValue" class="control-label span2">Degree</label>
                                        <div class="span2">
                                            <select id="DegreeTypeID" name="DegreeTypeID" class="span12">
                                                @foreach (var d in ViewBag.degreeTypes)
                                                {
                                                <option value="@d.DegreeTypeID">@d.DegreeTypeValue</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="DegreeDate" class="control-label span3">Degree Date</label>
                                        <div class="span9">
                                            <input type="text" class="form-control span6 date" name="DegreeDate" id="DegreeDate" />
                                        </div>
                                    </div>
                                    <!-- Fake SchoolsAttended ID -->
                                    <input type="hidden" id="SchoolsAttendedID" value="1" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <label for="Comments" class="control-label span2">Comments</label>
                            <div class="span10">
                                <textarea name="Comments" id="Comments" class="span12" rows="3" style="resize:vertical" placeholder="Comments regarding school attendance"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <input type="hidden" id="school-name" />
                            <button type="button" class="btn-success pull-left btn-ignore generate-classes">Generate Classes Tab</button>
                            <button type="button" class="btn-inverse pull-left btn-ignore edit-school-name">Edit School Name</button>
                            <button type="button" class="btn-danger pull-left btn-ignore remove-school">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="schools-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div> <!--End of first tab-->
            @{i = 1;}
            @foreach (var sa in ViewBag.schoolsAttended)
            {
            <div id="school-content-@i">
                <form class="form-horizontal schools-form">
                    <div class="row-fluid">
                        <!--School info block-->
                        <div class="span12 panel-body">
                            <div class="row-fluid">
                                <div class="span5">
                                    <div class="form-group">
                                        <label for="YearStart" class="control-label span3">Start Year</label>
                                        <div class="span4">
                                            <input type="text" class="form-control span10" name="YearStart" id="YearStart" value="@sa.YearStart" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="YearEnd" class="control-label span3">End Year</label>
                                        <div class="span4">
                                            <input type="text" class="form-control span10" name="YearEnd" id="YearEnd" value="@sa.YearEnd" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="Graduated" class="control-label span3">Graduated?</label>
                                        <div class="span2">
                                            <select id="Graduated" name="Graduated" class="span12">
                                                <option value="true" @if (sa.Graduated == true) { <text> selected </text>     }>Yes</option>
                                                <option value="false" @if (sa.Graduated == false) { <text> selected </text>     }>No</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!-- Fake values to pass test, get reassigned on submittal -->
                                    <input type="hidden" name="SchoolID" id="SchoolID" value="@sa.SchoolID" />
                                    <input type="hidden" name="BioDataID" id="BioDataID" value="@sa.BioDataID" />
                                </div>
                                <div class="span7">
                                    <!-- TODO: Need to have more than one major and more than one degree-->
                                    @foreach (var d in sa.Degrees)
                                        {
                                    <div class="form-group">
                                        <label for="MajorValue" class="control-label span3">Major</label>
                                        <div class="span4">
                                            <!--TODO: will be select2, because you can add a non-existing major-->
                                            <select id="MajorValue" name="MajorValue" class="span10">
                                                @foreach (var m in ViewBag.majors)
                                                        {
                                                    <option value="@m.MajorValue" @if (d.Major.MajorValue == m.MajorValue) { <text> selected </text>           }>@m.MajorValue</option>
                                                        }
                                            </select>
                                            <!-- Holder value, gets set on submit -->
                                            <input type="hidden" name="MajorID" id="MajorID" value="@d.MajorID" />
                                        </div>
                                        <label for="DegreeTypeValue" class="control-label span2">Degree</label>
                                        <div class="span2">
                                            <select id="DegreeTypeID" name="DegreeTypeID" class="span12">
                                                @foreach (var dt in ViewBag.degreeTypes)
                                                        {
                                                    <option value="@dt.DegreeTypeID" @if (d.DegreeTypeID == dt.DegreeTypeID) { <text> selected </text>           }>@dt.DegreeTypeValue</option>
                                                        }
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="DegreeDate" class="control-label span3">Degree Date</label>
                                        <div class="span9">
                                            <input type="text" class="form-control span6 date" name="DegreeDate" id="DegreeDate" value="@d.DegreeDate" />
                                        </div>
                                    </div>
                                    <!-- SchoolsAttended ID -->
                                    <input type="hidden" id="SchoolsAttendedIDReal" name="SchoolsAttendedID" value="@d.SchoolsAttendedID" />
                                        <input type="hidden" id="DegreeID" name="DegreeID" value="@d.DegreeID" />
                                        }
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <label for="Comments" class="control-label span2">Comments</label>
                            <div class="span10">
                                <textarea name="Comments" id="Comments" class="span12" rows="3" style="resize:vertical" placeholder="Comments regarding school attendance">@sa.Comments</textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <input type="hidden" id="school-name" value="@sa.School.SchoolValue" />
                            <button type="button" class="btn-success pull-left btn-ignore generate-classes">Generate Classes Tab</button>
                            <button type="button" class="btn-inverse pull-left btn-ignore edit-school-name">Edit School Name</button>
                            <button type="button" class="btn-danger pull-left btn-ignore remove-school">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="schools-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div> <!--End of first tab-->
                                        i++;
            }
            <div id="add-school">
                <form class="form-horizontal">
                    <div class="form-group">
                        <label for="SchoolValue" class="control-label span5">School Name</label>
                        <div class="span7">
                            <!--TODO: this will be a select2-->
                            <select id="SchoolValue" name="SchoolValue">
                                @foreach (var s in ViewBag.schools)
                                {
                                <option value="@s.SchoolID">@s.SchoolValue</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group text-center">
                        <button type="button" class="btn-success btn-ignore" id="add-school-button">Add School</button>
                    </div>
                </form>
            </div> <!--End of add school tab-->
        </div>
    </div>
</div>
<!--Class information block-->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="class-panel">
        <div class="panel-heading">
            <h2 class="panel-title">Class Information</h2>
        </div>
        <div class="tabs" id="class-tabs">
            <ul>
                <li class="hide"><a href="#class-content-1"></a></li>
                @{i = 1; int classCount = 0; int removeCount = 0;}
                @foreach (var sa in ViewBag.schoolsAttended)
                {
                    <li><a href="#class-content-@i">@sa.School.SchoolValue</a></li>
                    i++;
                }
            </ul>
            <div class="hide" id="class-content-1">
                <div id="year-tabs" class="tabs-vertical">
                    <ul>
                        <li id="year-tab-1"><a href="#year-content-1"></a></li>
                    </ul>
                    <div id="year-content-1">
                        <form class="form-horizontal class-form">
                            <input type="hidden" id="school-name" />
                            <div class="row-fluid">
                                <div class="span12 panel-body">
                                    <!-- Info about GPA and ranks -->
                                    <div class="form-group">
                                        <label for="GPA" class="control-label span2">GPA</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="GPA" id="GPA" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="AOMVal" class="control-label span2">AOM</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="AOMVal" id="AOMVal" />
                                        </div>
                                        <label for="AOMTot" class="control-label span1">of</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="AOMTot" id="AOMTot" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="OOMVal" class="control-label span2">OOM</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="OOMVal" id="OOMVal" />
                                        </div>
                                        <label for="OOMTot" class="control-label span1">of</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="OOMTot" id="OOMTot" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="InMajorVal" class="control-label span2">Rank in Major</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="InMajorVal" id="InMajorVal" />
                                        </div>
                                        <label for="InMajorTot" class="control-label span1">of</label>
                                        <div class="span3">
                                            <input type="text" class="form-control span12" name="InMajorTot" id="InMajorTot" />
                                        </div>
                                    </div>
                                    <hr />
                                    <!--Classes table-->
                                    <table class="classes-table">
                                        <thead>
                                            <tr>
                                                <th>Subject</th>
                                                <th>Code</th>
                                                <th>Name</th>
                                                <th>Grade</th>
                                                <th>Technical?</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <div class="span12">
                                    <div class="form-inline">
                                        <label for="Subject" class="control-label span1">Subject</label>
                                        <div class="span2">
                                            <input type="text" class="form-control span11" id="Subject" />
                                        </div>
                                    </div>
                                    <div class="form-inline">
                                        <label for="Code" class="control-label span1">Code</label>
                                        <div class="span1">
                                            <input type="text" class="form-control span11" id="Code" />
                                        </div>
                                    </div>
                                    <div class="form-inline">
                                        <label for="Name" class="control-label span1">Name</label>
                                        <div class="span2">
                                            <input type="text" class="form-control span12" id="Name" />
                                        </div>
                                    </div>
                                    <div class="form-inline">
                                        <label for="Grade" class="control-label span1">Grade</label>
                                        <div class="span1">
                                            <input type="text" class="form-control span12" id="Grade" />
                                        </div>
                                    </div>
                                    <div class="form-inline">
                                        <label for="Technical" class="control-label span1">Tech?</label>
                                        <div class="span1">
                                            <select id="Technical" class="span11">
                                                <option value="true">T</option>
                                                <option value="false">F</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <button class="pull-right course-catalog-trigger btn-ignore btn-inverse" type="button">Course Catalog</button>
                                <button class="pull-right btn-ignore btn-success add-class" type="button"><i class="fa fa-plus"></i> Add Class</button>
                            </div>
                            <!-- Fake SchoolsAttendedID, BioDataID, and ClassesID -->
                            <input type="hidden" name="SchoolsAttendedID" id="SchoolsAttendedID" value="1" />
                            <input type="hidden" name="BioDataID" id="BioDataID" value="1" />
                            <input type="hidden" name="ClassesID" id="ClassesID" value="1" />
                            <!-- Hidden inputs for YearTaken and YearOfRecord, get filled in on creation -->
                            <input type="hidden" name="YearTaken" id="YearTaken" value="" />
                            <input type="hidden" name="YearOfRecord" id="YearOfRecord" value="" />
                            <div class="row-fluid">
                                <div class="class-errors alert hide alert-error span10 offset1">
                                    <p></p>
                                </div>
                            </div>
                        </form>
                    </div> <!-- End of vertical content -->
                </div> <!-- End of vertical tabs -->
            </div> <!--End of first tab-->
            @{i = 1;}
            @foreach (var sa in ViewBag.schoolsAttended)
            {
                <div id="class-content-@i">
                    <div id="year-tabs" class="tabs-vertical">
                        <ul>
                            @{int diff = sa.YearEnd - sa.YearStart;}
                            @for (int j = 1; j <= diff; j++)
                            {
                                <li id="year-tab-@j"><a href="#year-content-@j">Year @j</a></li>
                            }
                        </ul>
                        @for (int j = 1; j <= diff; j++)
                        {
                            <div id="year-content-@j">
                                <form class="form-horizontal class-form">
                                    <input type="hidden" id="school-name" value="@sa.School.SchoolValue" />
                                    <div class="row-fluid">
                                        <div class="span12 panel-body">
                                            @foreach (var ss in sa.SchoolStandings)
                                            {
                                                if (ss.YearOfRecord == j) {
                                                <div class="form-group">
                                                    <label for="GPA" class="control-label span2">GPA</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="GPA" id="GPA" value="@ss.GPA" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="AOMVal" class="control-label span2">AOM</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="AOMVal" id="AOMVal" value="@ss.AOMVal" />
                                                    </div>
                                                    <label for="AOMTot" class="control-label span1">of</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="AOMTot" id="AOMTot" value="@ss.AOMTot" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="OOMVal" class="control-label span2">OOM</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="OOMVal" id="OOMVal" value="@ss.OOMVal" />
                                                    </div>
                                                    <label for="OOMTot" class="control-label span1">of</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="OOMTot" id="OOMTot" value="@ss.OOMTot" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="InMajorVal" class="control-label span2">Rank in Major</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="InMajorVal" id="InMajorVal" value="@ss.InMajorVal" />
                                                    </div>
                                                    <label for="InMajorTot" class="control-label span1">of</label>
                                                    <div class="span3">
                                                        <input type="text" class="form-control span12" name="InMajorTot" id="InMajorTot" value="@ss.InMajorTot" />
                                                    </div>
                                                </div>
                                                <input type="hidden" id="SchoolStandingsID" name="SchoolStandingsID" value="@ss.SchoolStandingsID" />
                                                }
                                            }
                                            <hr />
                                            <!--Classes table-->
                                            <table class="classes-table">
                                                <thead>
                                                    <tr>
                                                        <th>Subject</th>
                                                        <th>Code</th>
                                                        <th>Name</th>
                                                        <th>Grade</th>
                                                        <th>Technical?</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var ca in sa.ClassesAttended)
                                                    {
                                                        if (ca.YearTaken == j) {
                                                            removeCount++;
                                                        <tr>
                                                            <td>@ca.Classes.Subject</td>
                                                            <td>@ca.Classes.Code</td>
                                                            <td>@ca.Classes.Name</td>
                                                            <td>@ca.Grade</td>
                                                            <td>@ca.Classes.Technical</td>
                                                            <td class="text-center"><button class="btn-ignore btn-danger remove-class" data-remove="classes-form-@removeCount" type="button">Remove</button></td>
                                                        </tr>
                                                        }
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            <div class="form-inline">
                                                <label for="Subject" class="control-label span1">Subject</label>
                                                <div class="span2">
                                                    <input type="text" class="form-control span11" id="Subject" />
                                                </div>
                                            </div>
                                            <div class="form-inline">
                                                <label for="Code" class="control-label span1">Code</label>
                                                <div class="span1">
                                                    <input type="text" class="form-control span11" id="Code" />
                                                </div>
                                            </div>
                                            <div class="form-inline">
                                                <label for="Name" class="control-label span1">Name</label>
                                                <div class="span2">
                                                    <input type="text" class="form-control span12" id="Name" />
                                                </div>
                                            </div>
                                            <div class="form-inline">
                                                <label for="Grade" class="control-label span1">Grade</label>
                                                <div class="span1">
                                                    <input type="text" class="form-control span12" id="Grade" />
                                                </div>
                                            </div>
                                            <div class="form-inline">
                                                <label for="Technical" class="control-label span1">Tech?</label>
                                                <div class="span1">
                                                    <select id="Technical" class="span11">
                                                        <option value="true">T</option>
                                                        <option value="false">F</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <button class="pull-right course-catalog-trigger btn-ignore btn-success" type="button">Course Catalog</button>
                                        <button class="pull-right btn-ignore btn-success add-class" type="button"><i class="fa fa-plus"></i> Add Class</button>
                                    </div>
                                    <!-- SchoolsAttendedID, BioDataID, and ClassesID -->
                                    <input type="hidden" name="SchoolsAttendedID" id="SchoolsAttendedID" value="@sa.SchoolsAttendedID" />
                                    <input type="hidden" name="BioDataID" id="BioDataID" value="@sa.BioDataID" />
                                    <!--TODO: still need ClassesID here? -->
                                    <!-- Hidden inputs for YearTaken and YearOfRecord, get filled in on creation -->
                                    <input type="hidden" name="YearTaken" id="YearTaken" value="@j" />
                                    <input type="hidden" name="YearOfRecord" id="YearOfRecord" value="@j" />
                                    <div class="row-fluid">
                                        <div class="class-errors alert hide alert-error span10 offset1">
                                            <p></p>
                                        </div>
                                    </div>
                                    <input type="hidden" id="school-name" value="@sa.School.SchoolValue" />
                                </form>
                        @foreach (var ca in sa.ClassesAttended)
                        {
                            if (ca.YearTaken == j)
                            {
                                classCount++;
                               <form class="classes-form" id="classes-form-@classCount">
                                    <input type="hidden" name="Subject" value="@ca.Classes.Subject" />
                                    <input type="hidden" name="Code" value="@ca.Classes.Code" />
                                    <input type="hidden" name="Name" value="@ca.Classes.Name" />
                                    <input type="hidden" name="Grade" value="@ca.Grade" />
                                    <input type="hidden" name="Technical" value="@Convert.ToString(ca.Classes.Technical)" />
                                    <input type="hidden" id="ClassesID" name="ClassesID" value="@ca.Classes.ClassesID" />
                                   <input type="hidden" id="ClassesAttendedID" name="ClassesAttendedID" value="@ca.ClassesAttendedID"/>
                                </form>
                            }
                        }
                            </div><!-- End of vertical content -->
                        }
                    </div> <!-- End of vertical tabs -->
                </div>  <!--End of first tab-->
                        i++;
            }
        </div>
    </div>
</div>
<!--Duty history information block-->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="duty-history-panel">
        <div class="panel-heading">
            <h2 class="panel-title">Duty History/Duty Station Information</h2>
        </div>
        @foreach (var dh in ViewBag.dutyHistories)
        {
        <div class="row-fluid">
            <div class="span12 panel-body">
                <form class="form-horizontal" id="duty-history-form">
                    <div class="form-group">
                        <label for="Branch" class="control-label span2">Branch</label>
                        <div class="span4">
                            <select id="Branch" name="Branch" class="span10">
                                <option value="AF" @if (dh.Branch == "AF")
                                                   { <text>selected</text> }>Air Force</option>
                                <option value="Army" @if (dh.Branch == "Army")
                                                     { <text> selected </text> }>Army</option>
                                <option value="Navy" @if (dh.Branch == "Navy")
                                                     { <text> selected </text> }>Navy</option>
                                <option value="USMC" @if (dh.Branch == "USMC")
                                                     { <text> selected </text> }>USMC</option>
                            </select>
                        </div>
                        <label for="NUC" class="control-label span2">Prior NUC</label>
                        <div class="span4">
                            <select id="NUC" name="NUC" class="span10">
                                <option value="true" @if (dh.NUC == true)
                                                     { <text>selected</text> }>Yes</option>
                                <option value="false" @if (dh.NUC == false)
                                                      { <text> selected </text> }>No</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Rating" class="control-label span2">Rating</label>
                        <div class="span4">
                            <input type="text" class="form-control span10" name="Rating" id="Rating" value="@dh.Rating" />
                        </div>
                        <label for="Rank" class="control-label span2">Rank</label>
                        <div class="span4">
                            <input type="text" class="form-control span10" name="Rank" id="Rank" value="@dh.Rank" />
                        </div>
                    </div>
                    <input type="hidden" name="BioDataID" id="BioDataID" value="@dh.BioDataID" />
                    <input type="hidden" name="DutyHistoryID" id="DutyHistoryID" value="@dh.DutyHistoryID" />
                </form>
            </div>
        </div>
        <div class="row-fluid">
            <div id="duty-history-errors" class="alert hide alert-error span10 offset1">
                <p></p>
            </div>
        </div>
        <div class="tabs" id="duty-station-tabs">
            <ul>
                <li><a href="#duty-station-content-1">Duty Station</a></li>
                @{i = 1;}
                @foreach (var ds in dh.DutyStations)
                {
                    <li><a href="#duty-station-content-@i">Duty Station</a></li>
                }
                <li><a href="#add-duty-station"><i class="fa fa-plus"></i></a></li>
            </ul>
            <div class="hide" id="duty-station-content-1">
                <form class="form-horizontal duty-stations-form">
                    <input type="hidden" name="DutyHistoryID" id="DutyHistoryID" value="1" />
                    <div class="row-fluid">
                        <div class="span12 panel-body">
                            <div class="span6">
                                <div class="form-group">
                                    <label for="Name" class="control-label span2">Name</label>
                                    <div class="span10">
                                        <input type="text" class="form-control span6" name="Name" id="Name" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="GPA" class="control-label span2">GPA/Fitrep</label>
                                    <div class="span10">
                                        <input type="text" class="form-control span6" name="GPA" id="GPA" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="Duties" class="control-label span2">Duties</label>
                                    <div class="span10">
                                        <textarea name="Duties" id="Duties" class="span12" rows="3" style="resize:vertical" placeholder="Describe duties"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="Notes" class="control-label span2">Notes</label>
                                    <div class="span10">
                                        <textarea name="Notes" id="Notes" class="span12" rows="3" style="resize:vertical" placeholder="Notes about performance"></textarea>
                                    </div>
                                </div>
                            </div> <!--End of first column-->
                            <div class="span6">
                                <div class="form-group">
                                    <label for="ReportDate" class="control-label span3">Report Date</label>
                                    <div class="span9">
                                        <input type="text" class="date form-control" name="ReportDate" id="ReportDate" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="DepartDate" class="control-label span3">Depart Date</label>
                                    <div class="span9">
                                        <input type="text" class="date form-control" name="DepartDate" id="DepartDate" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="RankOverallVal" class="control-label span3">Overall Rank</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankOverallVal" id="RankOverallVal" />
                                    </div>
                                    <label for="RankOverallTot" class="control-label span1">of</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankOverallTot" id="RankOverallTot" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="RankInRateVal" class="control-label span3">Rank In Rate</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankInRateVal" id="RankInRateVal" />
                                    </div>
                                    <label for="RankInRateTot" class="control-label span1">of</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankInRateTot" id="RankInRateTot" />
                                    </div>
                                </div>
                            </div> <!--End of second column-->
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-duty-station">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="duty-stations-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div> <!--End of first tab-->
            @{i = 1;}
            @foreach (var ds in dh.DutyStations)
            {
            <div id="duty-station-content-@i">
                <form class="form-horizontal duty-stations-form">
                    <div class="row-fluid">
                        <div class="span12 panel-body">
                            <div class="span6">
                                <div class="form-group">
                                    <label for="Name" class="control-label span2">Name</label>
                                    <div class="span10">
                                        <input type="text" class="form-control span6" name="Name" id="Name" value="@ds.Name" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="GPA" class="control-label span2">GPA/Fitrep</label>
                                    <div class="span10">
                                        <input type="text" class="form-control span6" name="GPA" id="GPA" value="@ds.GPA" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="Duties" class="control-label span2">Duties</label>
                                    <div class="span10">
                                        <textarea name="Duties" id="Duties" class="span12" rows="3" style="resize:vertical" placeholder="Describe duties">@ds.Duties</textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="Notes" class="control-label span2">Notes</label>
                                    <div class="span10">
                                        <textarea name="Notes" id="Notes" class="span12" rows="3" style="resize:vertical" placeholder="Notes about performance">@ds.Notes</textarea>
                                    </div>
                                </div>
                            </div> <!--End of first column-->
                            <div class="span6">
                                <div class="form-group">
                                    <label for="ReportDate" class="control-label span3">Report Date</label>
                                    <div class="span9">
                                        <input type="text" class="date form-control" name="ReportDate" id="ReportDate" value="@ds.ReportDate" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="DepartDate" class="control-label span3">Depart Date</label>
                                    <div class="span9">
                                        <input type="text" class="form-control date" name="DepartDate" id="DepartDate" value="@ds.DepartDate" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="RankOverallVal" class="control-label span3">Overall Rank</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankOverallVal" id="RankOverallVal" value="@ds.RankOverallVal" />
                                    </div>
                                    <label for="RankOverallTot" class="control-label span1">of</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankOverallTot" id="RankOverallTot" value="@ds.RankOverallTot" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="RankInRateVal" class="control-label span3">Rank In Rate</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankInRateVal" id="RankInRateVal" value="@ds.RankInRateVal" />
                                    </div>
                                    <label for="RankInRateTot" class="control-label span1">of</label>
                                    <div class="span3">
                                        <input type="text" class="form-control span10" name="RankInRateTot" id="RankInRateTot" value="@ds.RankInRateTot" />
                                    </div>
                                </div>
                            </div> <!--End of second column-->
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-duty-station">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="duty-stations-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                    <input type="hidden" name="DutyHistoryID" id="DutyHistoryID" value="@dh.DutyHistoryID" />
                    <input type="hidden" name="DutyStationID" id="DutyStationID" value="@ds.DutyStationID" />
                </form>
            </div> <!--End of Duty Stations Tabs-->
            }
            <div id="add-duty-station">
                <form class="form-horizontal">
                    <div class="form-group text-center">
                        <button type="button" class="btn-success btn-ignore" id="add-duty-station-button">Add Duty Station</button>
                    </div>
                </form>
            </div> <!--End of add duty history tab-->
        </div> <!--End of all tabs-->
        }
    </div>
</div>
<!-- Waivers -->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="waivers-panel">
        <div class="panel-heading">
            <h2 class="panel-title">Waivers</h2>
        </div>
        <div class="tabs" id="waiver-tabs">
            <ul>
                <li class="hide"><a href="#waiver-content-1">Waiver</a></li>
                @{i = 1;}
                @foreach (var w in ViewBag.waivers)
                {
                <li><a href="#waiver-content-@i">Waiver</a></li>
                    i++;
                }
                <li><a href="#add-waiver"><i class="fa fa-plus"></i></a></li>
            </ul>
            <div class="hide" id="waiver-content-1">
                <form class="form-horizontal waivers-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" />
                    <div class="form-group">
                        <label for="Type" class="control-label span2">Type</label>
                        <div class="span3">
                            <select class="form-control span12" name="Type" id="Type">
                                <option value="Academic">Academic</option>
                                <option value="Age">Age</option>
                                <option value="Drug">Drug</option>
                            </select>
                        </div>
                        <label for="Date" class="control-label span2">Date</label>
                        <div class="span3">
                            <input class="form-control span12 date" type="text" name="Date" id="Date" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Comments" class="control-label span2">Comments</label>
                        <div class="span10">
                            <textarea class="form-control span12" name="Comments" id="Comments"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-waiver">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="waivers-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
            @{i = 1;}
            @foreach (var w in ViewBag.waivers)
            {
            <div id="waiver-content-@i">
                <form class="form-horizontal waivers-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" value="@ViewBag.bioData.ID"/>
                    <input type="hidden" name="WaiverID" id="WaiverID" value="@w.WaiverID" />
                    <div class="form-group">
                        <label for="Type" class="control-label span2">Type</label>
                        <div class="span3">
                            <select class="form-control span12" name="Type" id="Type">
                                <option value="ACADEMIC" @if (w.Type == WaiverType.Academic.ToString())
                                                         { <text> selected </text>     }>Academic</option>
                                <option value="AGE" @if (w.Type == WaiverType.Age.ToString())
                                                    { <text> selected </text>    }>Age</option>
                                <option value="DRUG" @if (w.Type == WaiverType.Drug.ToString())
                                                     { <text> selected </text>     }>Drug</option>
                            </select>
                        </div>
                        <label for="Date" class="control-label span2">Date</label>
                        <div class="span3">
                            <input class="form-control span12 date" type="text" name="Date" id="Date" value="@w.Date" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Comments" class="control-label span2">Comments</label>
                        <div class="span10">
                            <textarea class="form-control span12" name="Comments" id="Comments">@w.Comments</textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-waiver">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="waivers-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
                                                     i++;
            }
            <div id="add-waiver">
                <form class="form-horizontal">
                    <div class="form-group text-center">
                        <button type="button" class="btn-success btn-ignore" id="add-waiver-button">Add Waiver</button>
                    </div>
                </form>
            </div> <!--End of add waiver tab-->
        </div>
    </div>
</div>
<!-- Screens -->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="screens-panel">
        <div class="panel-heading">
            <h2 class="panel-title">Screens</h2>
        </div>
        <div class="tabs" id="screen-tabs">
            <ul>
                <li class="hide"><a href="#screen-content-1">Screen</a></li>
                @{i = 1;}
                @foreach (var s in ViewBag.screens)
                {
                <li><a href="#screen-content-@i">Screen</a></li>
                    i++;
                }
                <li><a href="#add-screen"><i class="fa fa-plus"></i></a></li>
            </ul>
            <div class="hide" id="screen-content-1">
                <form class="form-horizontal screens-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" />
                    <div class="form-group">
                        <label for="Screener" class="control-label span2">Screener</label>
                        <div class="span2">
                            <input type="text" class="form-control span12" name="Screener" id="Screener">
                        </div>
                        <label for="Location" class="control-label span2">Location</label>
                        <div class="span2">
                            <input type="text" class="form-control span12" name="Location" id="Location">
                        </div>
                        <label for="ScreenDate" class="control-label span2">Screen Date</label>
                        <div class="span2">
                            <input class="form-control span12 date" type="text" name="ScreenDate" id="ScreenDate" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="NRStatus" class="control-label span2">NR</label>
                        <div class="span2">
                            <select class="form-control span12" name="NRStatus" id="NRStatus">
                                <option value="Blank">--None--</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                                <option value="Pending">Pending</option>
                                <option value="Forward">Forward</option>
                                <option value="Maybe">Maybe</option>
                            </select>
                        </div>
                        <label for="INSTStatus" class="control-label span2">INST</label>
                        <div class="span2">
                            <select class="form-control span12" name="INSTStatus" id="INSTStatus">
                                <option value="Blank">--None--</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                                <option value="Pending">Pending</option>
                                <option value="Forward">Forward</option>
                                <option value="Maybe">Maybe</option>
                            </select>
                        </div>
                        <label for="NPSStatus" class="control-label span2">NPS</label>
                        <div class="span2">
                            <select class="form-control span12" name="NPSStatus" id="NPSStatus">
                                <option value="Blank">--None--</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                                <option value="Pending">Pending</option>
                                <option value="Forward">Forward</option>
                                <option value="Maybe">Maybe</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Notes" class="control-label span2">Notes</label>
                        <div class="span10">
                            <textarea class="form-control span12" name="Notes" id="Notes"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-screen">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="screens-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
            @{i = 1;}
            @foreach (var s in ViewBag.screens)
            {
            <div id="screen-content-@i">
                <form class="form-horizontal screens-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" value="@ViewBag.bioData.ID" />
                    <input type="hidden" name="ScreenID" id="ScreenID" value="@s.ScreenID" />
                    <div class="form-group">
                        <label for="Screener" class="control-label span2">Screener</label>
                        <div class="span2">
                            <input type="text" class="form-control span12" name="Screener" id="Screener" value="@s.Screener">
                        </div>
                        <label for="Location" class="control-label span2">Location</label>
                        <div class="span2">
                            <input type="text" class="form-control span12" name="Location" id="Location" value="@s.Location">
                        </div>
                        <label for="ScreenDate" class="control-label span2">Screen Date</label>
                        <div class="span2">
                            <input class="form-control span12 date" type="text" name="ScreenDate" id="ScreenDate" value="@s.ScreenDate" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="NRStatus" class="control-label span2">NR</label>
                        <div class="span2">
                            <select class="form-control span12" name="NRStatus" id="NRStatus">
                                <option value="Blank" @if (s.NRStatus == ScreenStatus.Blank.ToString())
                                                      { <text> selected </text>                  }>--None--</option>
                                <option value="Yes" @if (s.NRStatus == ScreenStatus.Yes.ToString())
                                                    { <text> selected </text>                  }>Yes</option>
                                <option value="No" @if (s.NRStatus == ScreenStatus.No.ToString())
                                                   { <text> selected </text>                  }>No</option>
                                <option value="Pending" @if (s.NRStatus == ScreenStatus.Pending.ToString())
                                                        { <text> selected </text>                  }>Pending</option>
                                <option value="Forward" @if (s.NRStatus == ScreenStatus.Forward.ToString())
                                                        { <text> selected </text>                  }>Forward</option>
                                <option value="Maybe" @if (s.NRStatus == ScreenStatus.Maybe.ToString())
                                                      { <text> selected </text>                  }>Maybe</option>
                            </select>
                        </div>
                        <label for="INSTStatus" class="control-label span2">INST</label>
                        <div class="span2">
                            <select class="form-control span12" name="INSTStatus" id="INSTStatus">
                                <option value="Blank" @if (s.INSTStatus == ScreenStatus.Blank.ToString())
                                                      { <text> selected </text>                   }>--None--</option>
                                <option value="Yes" @if (s.INSTStatus == ScreenStatus.Yes.ToString())
                                                    { <text> selected </text>                   }>Yes</option>
                                <option value="No" @if (s.INSTStatus == ScreenStatus.No.ToString())
                                                   { <text> selected </text>                   }>No</option>
                                <option value="Pending" @if (s.INSTStatus == ScreenStatus.Pending.ToString())
                                                        { <text> selected </text>                   }>Pending</option>
                                <option value="Forward" @if (s.INSTStatus == ScreenStatus.Forward.ToString())
                                                        { <text> selected </text>                   }>Forward</option>
                                <option value="Maybe" @if (s.INSTStatus == ScreenStatus.Maybe.ToString())
                                                      { <text> selected </text>                   }>Maybe</option>
                            </select>
                        </div>
                        <label for="NPSStatus" class="control-label span2">NPS</label>
                        <div class="span2">
                            <select class="form-control span12" name="NPSStatus" id="NPSStatus">
                                <option value="Blank" @if (s.NPSStatus == ScreenStatus.Blank.ToString())
                                                      { <text> selected </text>                   }>--None--</option>
                                <option value="Yes" @if (s.NPSStatus == ScreenStatus.Yes.ToString())
                                                    { <text> selected </text>                   }>Yes</option>
                                <option value="No" @if (s.NPSStatus == ScreenStatus.No.ToString())
                                                   { <text> selected </text>                   }>No</option>
                                <option value="Pending" @if (s.NPSStatus == ScreenStatus.Pending.ToString())
                                                        { <text> selected </text>                   }>Pending</option>
                                <option value="Forward" @if (s.NPSStatus == ScreenStatus.Forward.ToString())
                                                        { <text> selected </text>                   }>Forward</option>
                                <option value="Maybe" @if (s.NPSStatus == ScreenStatus.Maybe.ToString())
                                                      { <text> selected </text>                   }>Maybe</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="ScreenPrograms" class="control-label span2">Programs Applied For</label>
                        <div class="span2">
                            <select id="ScreenPrograms" name="ScreenPrograms" multiple>
                                @foreach (var p in ViewBag.programs) {
                                    <option value="@p.ProgramID" @if (s.ProgramsAppliedFor.Contains(p)) { <text> selected </text> }>@p.ProgramValue</option>
                                }
                            </select>
                        </div>
                        <label for="Notes" class="control-label span2">Notes</label>
                        <div class="span6">
                            <textarea rows="5" class="form-control span12" name="Notes" id="Notes">@s.Notes</textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-screen">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="screens-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
                                                      i++;
            }
            <div id="add-screen">
                <form class="form-horizontal">
                    <div class="form-group text-center">
                        <button type="button" class="btn-success btn-ignore" id="add-screen-button">Add Screen</button>
                    </div>
                </form>
            </div> <!--End of add screen tab-->
        </div>
    </div>
</div>
<!-- RD -->
<div class="row-fluid">
    <div class="span10 offset1 panel panel-primary" id="rds-panel">
        <div class="panel-heading">
            <h2 class="panel-title">RDs</h2>
        </div>
        <div class="tabs" id="rd-tabs">
            <ul>
                <li class="hide"><a href="#rd-content-1">RD</a></li>
                @{i = 1;}
                @foreach (var rd in ViewBag.RDs)
                {
                <li><a href="#rd-content-@i">RD</a></li>
                    i++;
                }
                <li><a href="#add-rd"><i class="fa fa-plus"></i></a></li>
            </ul>
            <div class="hide" id="rd-content-1">
                <form class="form-horizontal rds-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" />
                    <div class="form-group">
                        <label for="Type" class="control-label span2">Type</label>
                        <div class="span3">
                            <select class="form-control span12" name="Type" id="Type">
                                <option value="DEVOL">DEVOL</option>
                                <option value="RECLAMA">RECLAMA</option>
                            </select>
                        </div>
                        <label for="Date" class="control-label span2">Date</label>
                        <div class="span3">
                            <input class="date form-control span12" type="text" name="Date" id="Date" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Reason" class="control-label span2">Reason</label>
                        <div class="span10">
                            <textarea class="form-control span12" name="Reason" id="Reason"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-rd">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="rds-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
            @{i = 1;}
            @foreach (var rd in ViewBag.RDs)
            {
            <div id="rd-content-@i">
                <form class="form-horizontal rds-form">
                    <input type="hidden" name="BioDataID" id="BioDataID" value="@ViewBag.bioData.ID" />
                    <input type="hidden" name="RDID" id="RDID" value="@rd.RDID" />
                    <div class="form-group">
                        <label for="Type" class="control-label span2">Type</label>
                        <div class="span3">
                            <select class="form-control span12" name="Type" id="Type">
                                <option value="DEVOL" @if (rd.Type == RDType.DEVOL.ToString())
                                                      { <text> selected </text>              }>DEVOL</option>
                                <option value="RECLAMA" @if (rd.Type == RDType.RECLAMA.ToString())
                                                        { <text> selected </text>             }>RECLAMA</option>
                            </select>
                        </div>
                        <label for="Date" class="control-label span2">Date</label>
                        <div class="span3">
                            <input class="date form-control span12" type="text" name="Date" id="Date" value="@rd.Date" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Reason" class="control-label span2">Reason</label>
                        <div class="span10">
                            <textarea class="form-control span12" name="Reason" id="Reason">@rd.Reason</textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <button type="button" class="btn-danger pull-left btn-ignore remove-rd">Remove</button>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="rds-errors alert hide alert-error span10 offset1">
                            <p></p>
                        </div>
                    </div>
                </form>
            </div>
                                                        i++;
            }
            <div id="add-rd">
                <form class="form-horizontal">
                    <div class="form-group text-center">
                        <button type="button" class="btn-success btn-ignore" id="add-rd-button">Add RD</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Buttons at buttom of page -->
<div class="row-fluid">
    <div class="span12">
        <button type="button" id="create-candidate-button" class="btn-success span4 offset2 btn-ignore">Create</button>
        <button type="button" id="cancel-candidate-button" class="btn-danger span4 btn-ignore">Cancel</button>
    </div>
</div>
<div id="dialog-confirm" title="">
    <p></p>
</div>
<div id="submitting-dialog" title="Submitting Candidate">
    <p>Submitting Candidate...</p>
</div>
<div id="course-catalog-modal" title="Course Catalog">
    <h2 class="text-center"><span id="school-name-catalog"></span> Courses</h2>
    <table id="course-catalog-table">
        <thead>
            <tr>
                <th>Subject</th>
                <th>Code</th>
                <th>Name</th>
                <th>Tech</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
<div id="change-school-name-modal" title="Change School Name">
    <label for="new-school-name">Name</label>
    <input type="text" id="new-school-name" />
</div>

@section AddToScripts {
<script src="@Url.Content("~/Scripts/tabcontrols.js")"></script>
<script src="@Url.Content("~/Scripts/biodatatest.js")"></script>
<script src="@Url.Content("~/Scripts/biodatasubmit.js")"></script>
    <script type="text/javascript">

        // Counter to wait for ajax calls
        var counter = 0;
        var catalogForm;
        var catalogSchool;

        /**
         * Function to show and set data/callbacks for a confirmation dialog
         * Params:
         *  title - (String) Title for the new dialog
         *  message - (String) Message for the new dialog
         *  okOnly - (Boolean) T/F if the dialog should just have an OK button, otherwise will have OK and cancel
         *  okFunction - (Function) Callback function on OK press
         */
        function showDialog(title, message, okOnly, okFunction) {
            $("#dialog-confirm p").html(message);
            var buttons;
            if (okOnly) {
                buttons = {
                    Ok: function () {
                        okFunction();
                        $(this).dialog("close");
                    }
                }
            } else {
                buttons = {
                    Ok: function () {
                        okFunction();
                        $(this).dialog("close");
                    },
                    Close: function () {
                        $(this).dialog("close");
                    }
                }
            }

            $("#dialog-confirm").dialog({
                title: title,
                modal: true,
                buttons: buttons
            });
        }

        /**
         * Sets an interval to wait for a certain condition to be true
         * Params:
         *  check - (Function) Function to run that returns T/F
         *  onComplete - (Function) Function to run when check returns true
         */
        function waitUntil(check, onComplete) {
            // if the check returns true, execute onComplete immediately
            if (check()) {
                onComplete();
                return;
            }
            var timeoutPointer;
            var intervalPointer = setInterval(function () {
                if (!check()) return;

                clearInterval(intervalPointer);
                if (timeoutPointer) clearTimeout(timeoutPointer);
                onComplete();
            }, 100);
        }

        /**
         * Checks if any errors existed after testing. If so, show the errors. Else, start
         *      submittal chain.
         */
        function checkErrors() {
            var allPass = true;
            //Clear all errors
            $(".alert").addClass("hide");
            $(".alert > p").html("");
            for (var key in passDict) {
                var errors = passDict[key];
                $("#" + key + "-panel").removeClass("panel-error");
                if (Object.keys(errors).length > 0) {
                    allPass = false;
                    //Show errors in correct place
                    $("#" + key + "-panel").addClass("panel-error");
                    if (key == "biodata" || key == "duty-history") {
                        $("#" + key + "-errors > p").html(errors[0]);
                        $("#" + key + "-errors").removeClass("hide");
                    } else {
                        //Get forms
                        var forms = $("." + key + "-form");
                        for (var i in errors) {
                            $(forms[i]).find("." + key + "-errors > p").html(errors[i]);
                            $(forms[i]).find("." + key + "-errors").removeClass("hide");
                        }
                    }
                }
            }
            //Clear out dict
            passDict = {
                "biodata": {},
                "schools": {},
                "class": {},
                "duty-history": {},
                "duty-stations": {},
                "waivers": {},
                "screens": {},
                "rds": {}
            };
            if (allPass == true) {
                // No errors, start submittal chain
                console.log("passed testing");
                submit();
            } else {
                //Close dialog at end
                $("#submitting-dialog").dialog("close");
            }
        }

        $(document).ready(function () {

            // Init horizontal and vertical tabs
            $(".tabs").tabs();
            $(".tabs-vertical").tabs().addClass("ui-tabs-vertical ui-helper-clearfix");
            $(".tabs-vertical li").removeClass("ui-corner-top").addClass("ui-corner-left");

            // Set datepickers
            $(".date").datepicker({
                changeYear: true,
                yearRange: "-90:+0"
            });

            // Init dialog for candidate submittal
            $("#submitting-dialog").dialog({
                autoOpen: false,
                modal: true,
                dialogClass: "no-close"
            });

            $("#course-catalog-modal").dialog({
                autoOpen: false,
                model: true,
                width: $(window).width() * .30,
                height: $(window).height() * 1,
                position: {
                    my: "left",
                    at: "left",
                    of: window
                }
            });

            $("#change-school-name-modal").dialog({
                autoOpen: false
            });

            $(document).on("click", ".course-catalog-trigger", function () {
                console.log("open");
                catalogForm = $(this).parent().parent();
                console.log(catalogForm);
                catalogTable = $(catalogForm).find(".classes-table");
                console.log(catalogTable);
                catalogSchool = $(catalogForm).find("#school-name").val();
                console.log(catalogSchool);
                $("#school-name-catalog").text(catalogSchool);
                var obj = { "School": catalogSchool };
                // Get courses
                $.ajax({
                    url: baseURL + "/api/ClassesAttended/GetCourseCatalog?" + $.param(obj),
                    type: "Get",
                    success: function (data) {
                        console.log("success");
                        console.log(data);
                        // Clear out table
                        $("#course-catalog-table tbody").empty();
                        if (data.length == 0) {
                            $("#course-catalog-table tbody").append(
                                "<p class='text-center'>No classes for this school</p>"
                            );
                        }
                        for (var i = 0; i < data.length; i++) {
                            var c = data[i].classes;
                            var tech = "" + c.Technical;
                            $("#course-catalog-table tbody").append(
                                "<tr>" +
                                    "<td>" + c.Subject + "</td>" +
                                    "<td>" + c.Code + "</td>" +
                                    "<td>" + c.Name + "</td>" +
                                    "<td>" + tech.charAt(0).toUpperCase() + tech.slice(1) + "</td>" +
                                    "<td><button class='add-class-catalog' type='button' data-id='" + c.ClassesID + "'><i class='fa fa-plus'></i></button></td>" +
                                "</tr>"
                            );
                        }
                        // Re-init buttons
                        $("#course-catalog-table button").button();
                        // Open modal
                        $("#course-catalog-modal").dialog("open");
                    },
                    error: function (data) {
                        console.log("error");
                        console.log(data);
                    }
                });

            });

            $(document).on("click", ".add-class-catalog", function () {
                var classID = $(this).data("id");
                // Get class data
                $.ajax({
                    url: baseURL + "/api/Classes/Get/" + classID,
                    type: "Get",
                    success: function (data) {
                        console.log("success");
                        console.log(data);
                        // Populate correct classes table
                        $(catalogForm).find("#Subject").val(data.Subject);
                        $(catalogForm).find("#Code").val(data.Code);
                        $(catalogForm).find("#Name").val(data.Name);
                        $(catalogForm).find("#Technical").val("" + data.Technical);
                    },
                    error: function (data) {
                        console.log("error");
                        console.log(data);
                    }
                })
            });

            // Create Candidate button click
            $("#create-candidate-button").click(function () {
                console.log("starting test");
                // Show dialog to prevent any further clicking
                $("#submitting-dialog").dialog("open");
                // Start testing chain
                testBioData();
            });

            // Set tab counters
            numSchools = schoolCounter = classCounter = @ViewBag.schoolCount + 0;
            classesCounter = @classCount + 0;
            numDutyStations = dutyStationCounter = @ViewBag.dutyStationsCount + 0;
            numWaivers = waiverCounter = @ViewBag.waiversCount + 0;
            numScreens = screenCounter = @ViewBag.screensCount + 0;
            numRDs = rdCounter = @ViewBag.rdCount + 0;

            // Add schools to schoolList
            @foreach (var s in ViewBag.schoolsAttended)
            {
                <text>schoolList.push("@s.School.SchoolValue");</text>
            }

            // Set BioDataID
            bioDataId = @ViewBag.bioData.ID +0;

            // School Select2
            $("#SchoolValue").select2({
                placeholder: "Select School"
            }).parent().find('.select2-with-searchbox')
            .prepend('<div class="createLink"><a href="#">Add New School</a></div>')
            .on('click', '.createLink', function (e) {
                e.preventDefault();
                var name = $(this).parent().find(".select2-search input").val().toUpperCase();
                if (name != "") {
                    addSchool(1, name);
                }
                // Close dropdown
                $("#SchoolValue").select2("close");
            });

            $(document).on("click", ".edit-school-name", function (e) {
                var btn = this;
                var schoolName = $(this).parent().find("#school-name").val();
                $("#change-school-name-modal #new-school-name").val(schoolName);
                $("#change-school-name-modal").dialog({
                    modal: true,
                    buttons: {
                        Ok: function () {
                            // Set new school name
                            var newName = $("#change-school-name-modal #new-school-name").val().toUpperCase();
                            console.log(newName);
                            // Set school-name
                            $(btn).parent().find("#school-name").val(newName);
                            // Set school tab name
                            $("#school-tabs ul li:contains('" + schoolName + "') a").text(newName);
                            // Set class tab info if there is one
                            if ($("#class-tabs ul li:contains('" + schoolName + "')").length > 0) {
                                // Set school-name in each class-form
                                console.log($("#class-tabs ul li:contains('" + schoolName + "') a"));
                                var href = $("#class-tabs ul li:contains('" + schoolName + "') a").attr("href");
                                // Set class tab name
                                $("#class-tabs ul li:contains('" + schoolName + "') a").text(newName);
                                console.log(href);
                                var classForms = $(href).find(".class-form");
                                console.log(classForms);
                                for (var i = 0; i < classForms.length; i++) {
                                    $(classForms[i]).find("#school-name").val(newName);
                                }
                            }
                            $(this).dialog("close");
                        },
                        Close: function () {
                            $(this).dialog("close");
                        }
                    }
                });
            });

            $("#cancel-candidate-button").click(function () {
                // Just refresh page
                var href = "@Url.Action("Edit", "Candidates", new { id = "__id__" })";
                href = href.replace("__id__", bioDataId);
                window.location.href = href;
            });

            // Set Major Select2's
            var initSchoolForms = $(".schools-form");
            console.log(initSchoolForms);
            for (var i = 0; i < initSchoolForms.length; i++) {
                var f = initSchoolForms[i];
                console.log(f);
                $(f).find("#MajorValue").select2({
                    placeholder: "Select Major"
                }).parent().find(".select2-with-searchbox")
               .prepend('<div class="createLink"><a href="#">Add New Major</a></div>')
               .on('click', '.createLink', function (e) {
                   e.preventDefault();
                   var name = $(this).parent().find(".select2-search input").val().toUpperCase();
                   console.log(name);
                   $(f).find("#MajorValue").append(
                       "<option value='" + name + "'>" + name + "</option>"
                   );
                   $(f).find("#MajorValue").select2("val", name);
                   $(f).find("#MajorValue").select2("close");
               });
            }

        }); // End document ready

    </script>
}
